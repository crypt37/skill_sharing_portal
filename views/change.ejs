<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
          crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css"/>
    <link rel="stylesheet" href="css/styles2.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pikaday/pikaday.js"></script>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/pikaday/css/pikaday.css"/>
</head>

<body>


<form action="/change" method="POST" class="requires-validation">

    <h1>Sign Up</h1>

    <fieldset>

        <legend><span class="number">1</span> Your basic info</legend>

        <label for="username">Name:</label>
        <input type="text" name="username" placeholder="Full Name" value="<%= username %>" required>

        <label for="email">Email:</label>
        <input type="email" name="email" placeholder="E-mail Address"  value=" <%= email %>"  required>

        <label for="password">Password:</label>
        <input type="password" name="password" placeholder="password" autocomplete="off"  minlength="5" required >

        <div ><label for="birth_date">Birth Date: </label>

            <input type="text"  name="dob" id="birth_date"  required /></div>
        <div id="ages"  style=" padding-bottom: 0.3em"> </div>
        <input type="hidden" name="age" id = 'age' placeholder="age" value="<%= Age%>" />


        <label for="gender" id ="gender"> Select you gender</label>
        <select name="gender">
            <option value="male" id="male">Male</option>
            <option value="female" id="female">Female</option>
            <option value="other" id="'other" >other</option>
        </select>
        <label for="image">image link:</label>
        <input type="text" name="image" placeholder="image"  value="<%= image%>" >
        <label for="name">A short descripttion about you  (max 50 ):</label>

        <input type="text" id="About" name="About" required
               minlength="1" maxlength="50" size="10"  value="<%= About %>">

        <div class="col-md-12 mt-3">
            <legend><span class="number">2</span>  your skill details :</legend>
            <h5> you are Expert on :</h5>
            <select class="selectpicker" multiple data-live-search="true" name="expert"  id = "Expert">

                <optgroup label="Web Development">
                    <option id="JQuery" value="JQuery">jQuery</option>
                    <option  id="Bootstrap" value="Bootstrap">Bootstrap</option>
                    <option  id=HTML" value="HTML">HTML</option>
                    <option id="CSS"  value="CSS">CSS</option>
                    <option id="Angular" value="Angular">Angular</option>
                </optgroup>
                <optgroup label="Programming Languages">
                    <option id="java" value="java">Java</option>
                    <option id="csharp" value="csharp">C#</option>
                    <option id="Python" value="Python">Python</option>
                </optgroup>
                <optgroup label="Databases">
                    <option id="MySql"  value="MySql">MySQL</option>
                    <option id="Oracle" value="Oracle">Oracle</option>

                </optgroup>
            </select>
        </div>
        <div class="col-md-12 mt-3">
            <h5> you are intermediate  on :</h5>
            <select class="selectpicker" multiple data-live-search="true" name="intermdiate" id = "Intermediate">

                <optgroup label="Web Development">
                    <option id="JQuery" value="JQuery">jQuery</option>
                    <option  id="Bootstrap" value="Bootstrap">Bootstrap</option>
                    <option  id=HTML" value="HTML">HTML</option>
                    <option id="CSS"  value="CSS">CSS</option>
                    <option id="Angular" value="Angular">Angular</option>
                </optgroup>
                <optgroup label="Programming Languages">
                    <option id="java" value="java">Java</option>
                    <option id="csharp" value="csharp">C#</option>
                    <option id="Python" value="Python">Python</option>
                </optgroup>
                <optgroup label="Databases">
                    <option id="MySql"  value="MySql">MySQL</option>
                    <option id="Oracle" value="Oracle">Oracle</option>

                </optgroup>
            </select>
        </div>
        <div class="col-md-12 mt-3">
            <h5> you want to learn :</h5>
            <select class="selectpicker" multiple data-live-search="true" name="noob" id ="Beginner">

                <optgroup label="Web Development">
                    <option id="JQuery" value="JQuery">jQuery</option>
                    <option  id="Bootstrap" value="Bootstrap">Bootstrap</option>
                    <option  id=HTML" value="HTML">HTML</option>
                    <option id="CSS"  value="CSS">CSS</option>
                    <option id="Angular" value="Angular">Angular</option>
                </optgroup>
                <optgroup label="Programming Languages">
                    <option id="java" value="java">Java</option>
                    <option id="csharp" value="csharp">C#</option>
                    <option id="Python" value="Python">Python</option>
                </optgroup>
                <optgroup label="Databases">
                    <option id="MySql"  value="MySql">MySQL</option>
                    <option id="Oracle" value="Oracle">Oracle</option>

                </optgroup>
            </select>
        </div>


    </fieldset>


    <button type="submit">Sign Up</button>

</form>
<script>
    function checkDuplicates(){
        var codes = $('select[class^="selectpicker"]').map(function(element){
            window.alert;
            return element.value;
        })
        var duplicates = codes.some(function(element, index, self){
            return element && codes.indexOf(element) !== index;
        });
        return duplicates;
    }

    function flagDuplicates(){
        var inputs = $('select[class^="selectpicker"]').toArray();
        var codes = inputs.map(function(element){
            return element.value;
        });
        var duplicates = 0;
        codes.forEach(function(element, index){
            var duplicate = element && codes.indexOf(element) !== index;
            if(duplicate){
                alert(inputs[index].value+ "  is a duplicate item " );

                inputs[index].value = false;
                duplicates++
            }
        });
        return duplicates;
    }
    $('select[class^="selectpicker"]').on("change", function(){

        flagDuplicates();
    });

    function calculateAge(date)
    {
        const now = new Date();
        const diff = Math.abs(now - date );
        const age = Math.floor(diff / (1000 * 60 * 60 * 24 * 365));
        return age
    }

    var picker = new Pikaday({
        field: document.getElementById('birth_date') ,
        yearRange:[1900,2020],
        onSelect: function(date) {
            let age = calculateAge(date);
            document.getElementById('ages').innerHTML = "age: "+age ;
            document.getElementById("age").value = age;
        }
    });


     $("select option[value='<%= gender %>']").attr("selected","selected");
 <% if (language){ language.forEach(function (lang){   if (lang.skl_level === "Expert") {count=(Math.floor(Math.random() * 10 +90));} else if (lang.skl_level==='Intermediate') {count= (Math.floor(Math.random() * 20)+40);} else {count= Math.floor(Math.random() * 10);}  %>

    $("#<%=lang.skl_level   %>   option[value='<%= lang.skl_name %>']").attr("selected","selected");
    <% })};%>
</script>
</body>
</html>

